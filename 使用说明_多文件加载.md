# 多文件加载功能使用说明

## 📋 功能概述

现在网页系统已升级，支持自动加载 `./analysis_results/` 目录下的**所有** JSON 分析文件，而不是只加载单一文件。

## 🚀 使用步骤

### 1️⃣ 添加新的分析文件

将新的分析结果 JSON 文件放入 `analysis_results` 目录：

```
analysis_results/
  ├── ai_reputation_analysis_20251119_163327.json
  ├── ai_reputation_analysis_20251120_100000.json  ← 新文件
  └── ai_reputation_analysis_20251121_150000.json  ← 新文件
```

### 2️⃣ 生成文件索引

每次添加或删除 JSON 文件后，运行索引生成脚本：

**Windows 命令行：**
```bash
python generate_index.py
```

**或者双击运行：**
- 直接双击 `generate_index.py` 文件

### 3️⃣ 刷新网页

打开或刷新 `index.html`，系统会自动加载所有文件的数据。

## 📊 工作原理

1. **索引生成脚本** (`generate_index.py`)
   - 扫描 `analysis_results` 目录
   - 生成 `files_index.json` 索引文件
   - 记录所有可用的 JSON 数据文件

2. **前端自动加载** (`index.html`)
   - 读取 `files_index.json` 获取文件列表
   - 并行加载所有 JSON 文件
   - 合并数据并分配全局唯一 ID
   - 在界面中显示所有数据

## ✨ 功能特点

- ✅ **自动合并**：多个文件的数据自动合并到一个列表
- ✅ **来源追踪**：每条数据都记录来自哪个源文件
- ✅ **全局 ID**：自动为所有数据分配连续的唯一 ID
- ✅ **容错处理**：单个文件加载失败不影响其他文件
- ✅ **性能优化**：并行加载多个文件，提升速度

## 🔍 数据展示

在详情页面中，你可以看到每条数据的来源文件：

```
Data Source: ai_reputation_analysis_20251119_163327.json
```

## ⚠️ 注意事项

1. **JSON 文件格式**
   - 确保所有 JSON 文件具有相同的数据结构
   - 必须包含必需字段：`User_Query`, `AI_Response`, `Platform` 等

2. **索引文件更新**
   - 每次修改 `analysis_results` 目录内容后，必须重新运行 `generate_index.py`
   - 索引文件不会自动更新

3. **文件命名**
   - 建议使用时间戳命名：`ai_reputation_analysis_YYYYMMDD_HHMMSS.json`
   - 文件列表会按名称倒序排列（最新的在前）

## 🛠️ 故障排除

### 错误：无法加载文件索引

**解决方案：** 运行 `python generate_index.py` 生成索引文件

### 错误：没有成功加载任何数据文件

**检查：**
1. JSON 文件格式是否正确
2. 文件路径是否正确
3. 打开浏览器控制台查看详细错误信息

### 数据显示不全

**检查：**
1. 确认所有 JSON 文件都在索引中
2. 刷新浏览器缓存（Ctrl+F5）
3. 查看浏览器控制台的加载日志

## 📝 开发日志

- **2025-11-21**: 实现多文件自动加载功能
  - 创建索引生成脚本
  - 修改前端加载逻辑
  - 支持数据合并和来源追踪

